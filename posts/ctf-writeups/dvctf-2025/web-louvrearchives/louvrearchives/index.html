<!doctype html><html lang=en><head><title>DVCTF 2025 - WEB LouvreArchives · Anthrace | CTF Writeups</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="Anthrace"><meta name=description content="
Dans ce chall  il faut acceder flag.webp et on le code source.
En explorant un peu la page, j’ai remarqué une longue chaîne encodée en base64. Une fois décodée et réorganisée, elle contenait plusieurs images .webp portant des noms étranges comme 1991781613.webp, 1273827392.webp, etc.
En consultant le code source :

On comprend que les noms des fichiers sont générés avec getrandbits(32) de Python, c’est-à-dire 32 bits aléatoires produits par la fonction random.getrandbits."><meta name=keywords content="ctf,hacking,cybersecurity,writeups,web,osint,forensic,crypto"><meta name=twitter:card content="summary"><meta name=twitter:title content="DVCTF 2025 - WEB LouvreArchives"><meta name=twitter:description content="Dans ce chall il faut acceder flag.webp et on le code source.
En explorant un peu la page, j’ai remarqué une longue chaîne encodée en base64. Une fois décodée et réorganisée, elle contenait plusieurs images .webp portant des noms étranges comme 1991781613.webp, 1273827392.webp, etc.
En consultant le code source :
On comprend que les noms des fichiers sont générés avec getrandbits(32) de Python, c’est-à-dire 32 bits aléatoires produits par la fonction random.getrandbits."><meta property="og:url" content="https://anthr4ce.github.io/posts/ctf-writeups/dvctf-2025/web-louvrearchives/louvrearchives/"><meta property="og:site_name" content="Anthrace | CTF Writeups"><meta property="og:title" content="DVCTF 2025 - WEB LouvreArchives"><meta property="og:description" content="Dans ce chall il faut acceder flag.webp et on le code source.
En explorant un peu la page, j’ai remarqué une longue chaîne encodée en base64. Une fois décodée et réorganisée, elle contenait plusieurs images .webp portant des noms étranges comme 1991781613.webp, 1273827392.webp, etc.
En consultant le code source :
On comprend que les noms des fichiers sont générés avec getrandbits(32) de Python, c’est-à-dire 32 bits aléatoires produits par la fonction random.getrandbits."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-07-01T00:00:00+00:00"><meta property="article:modified_time" content="2025-07-01T00:00:00+00:00"><meta property="article:tag" content="Dvctf"><meta property="article:tag" content="Crypto"><meta property="article:tag" content="Web"><meta property="article:tag" content="Writeup"><link rel=canonical href=https://anthr4ce.github.io/posts/ctf-writeups/dvctf-2025/web-louvrearchives/louvrearchives/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.6445a802b9389c9660e1b07b724dcf5718b1065ed2d71b4eeaf981cc7cc5fc46.css integrity="sha256-ZEWoArk4nJZg4bB7ck3PVxixBl7S1xtO6vmBzHzF/EY=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/custom.min.fc155f6647e32b79568a40df779b1040eb830a7dde8130f42472f995f92ed186.css integrity="sha256-/BVfZkfjK3lWikDfd5sQQOuDCn3egTD0JHL5lfku0YY=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-light"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://anthr4ce.github.io/>Anthrace | CTF Writeups
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/posts/>Writeups</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://anthr4ce.github.io/posts/ctf-writeups/dvctf-2025/web-louvrearchives/louvrearchives/>DVCTF 2025 - WEB LouvreArchives</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2025-07-01T00:00:00Z>2025-07-01
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
2-minute read</span></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/dvctf/>Dvctf</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/crypto/>Crypto</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/web/>Web</a>
</span><span class=separator>•</span>
<span class=tag><a href=/tags/writeup/>Writeup</a></span></div></div></header><div class=post-content><p><img src=images/img1.png alt=Screenshot></p><p>Dans ce chall il faut acceder flag.webp et on le code source.</p><p>En explorant un peu la page, j’ai remarqué une longue chaîne encodée en base64. Une fois décodée et réorganisée, elle contenait plusieurs images <code>.webp</code> portant des noms étranges comme <code>1991781613.webp</code>, <code>1273827392.webp</code>, etc.</p><p>En consultant le code source :</p><p><img src=images/img2.png alt=Screenshot></p><p>On comprend que les noms des fichiers sont générés avec <code>getrandbits(32)</code> de Python, c’est-à-dire 32 bits aléatoires produits par la fonction <code>random.getrandbits</code>.</p><p>Ce qui est intéressant ici, c’est que cette fonction utilise le <strong>générateur Mersenne Twister</strong>, un PRNG (Pseudo-Random Number Generator) <strong>non cryptographiquement sûr</strong>.</p><hr><h3 id=-study-time-le-mersenne-twister>🧠 Study time: le Mersenne Twister
<a class=heading-link href=#-study-time-le-mersenne-twister><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>Le <strong>Mersenne Twister</strong> est un générateur pseudo-aléatoire très utilisé (par exemple, par défaut dans le module <code>random</code> de Python).<br>Il génère des entiers de 32 bits à partir d’un <strong>état interne de 624 entiers de 32 bits</strong>. Une fois cet état connu, tous les nombres suivants peuvent être <strong>prédits avec précision</strong>.</p><p>Mais il y a un piège : les valeurs générées sont &ldquo;temperées&rdquo; (tempérées), c’est-à-dire transformées par une fonction pour améliorer leur distribution.<br>Pour reconstituer l’état interne, il faut <strong>&ldquo;détermer&rdquo;</strong> (untamper) les valeurs.</p><hr><h3 id=-exploitation>🔓 Exploitation
<a class=heading-link href=#-exploitation><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>Puisqu’on peut <strong>voir plus de 624 fichiers <code>.webp</code> nommés avec <code>getrandbits(32)</code></strong>, on a suffisamment de sorties pour reconstruire l’état interne du générateur.</p><p>J’ai utilisé ce repo :<br>👉 <a href=https://github.com/kmyk/mersenne-twister-predictor class=external-link target=_blank rel=noopener>https://github.com/kmyk/mersenne-twister-predictor</a></p><p>Ce qu’il fait :</p><ol><li>Il prend <strong>624 sorties</strong> (les noms de fichiers en l’occurrence),</li><li>Applique l’<strong>algorithme d’&ldquo;untempering&rdquo;</strong> pour retrouver l’état original,</li><li>Permet ensuite de <strong>prédire les futures valeurs</strong> du générateur.</li></ol><p>Grâce à ça, on retrouve la <strong>clé secrète utilisée pour signer les JWT</strong> :</p><p><code>1991781613</code></p><hr><h3 id=-création-dun-jwt-forgé>🎟️ Création d’un JWT forgé
<a class=heading-link href=#-cr%c3%a9ation-dun-jwt-forg%c3%a9><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>À partir de cette clé, on peut créer un JWT customisé avec comme image de profil la fameuse image <code>flag.webp</code> :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> jwt<span style=color:#f92672>,</span> datetime
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>secret <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;1991781613&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>payload <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;sub&#39;</span>: <span style=color:#e6db74>&#39;user_id&#39;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;exp&#39;</span>: datetime<span style=color:#f92672>.</span>datetime<span style=color:#f92672>.</span>utcnow() <span style=color:#f92672>+</span> datetime<span style=color:#f92672>.</span>timedelta(hours<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;iat&#39;</span>: datetime<span style=color:#f92672>.</span>datetime<span style=color:#f92672>.</span>utcnow(),
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;profilepicture&#39;</span>: <span style=color:#e6db74>&#39;./images/flag.webp&#39;</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>token <span style=color:#f92672>=</span> jwt<span style=color:#f92672>.</span>encode(
</span></span><span style=display:flex><span>    payload,
</span></span><span style=display:flex><span>    secret,
</span></span><span style=display:flex><span>    algorithm<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;HS256&#39;</span>,
</span></span><span style=display:flex><span>    headers<span style=color:#f92672>=</span>{<span style=color:#e6db74>&#39;alg&#39;</span>:<span style=color:#e6db74>&#39;HS256&#39;</span>,<span style=color:#e6db74>&#39;typ&#39;</span>:<span style=color:#e6db74>&#39;JWT&#39;</span>}
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(token)
</span></span></code></pre></div><hr><h3 id=-récupération-du-flag>📦 Récupération du flag
<a class=heading-link href=#-r%c3%a9cup%c3%a9ration-du-flag><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>On remplace le cookie JWT dans Burp:</p><p><img src=images/img3.png alt=Screenshot></p><p>Et on obtient :</p><p><img src=images/img4.png alt=Screenshot></p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2025
Anthrace
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>