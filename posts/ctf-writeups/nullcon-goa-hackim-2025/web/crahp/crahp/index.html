<!doctype html><html lang=en><head><title>Nullcon-Goa-HackIM-2025 - Web ¬∑ Anthrace | CTF Writeups</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="Anthrace"><meta name=description content="
  Web Challenge - CRC Hash Collision Exploit
  
    
    Link to heading
  



  Challenge Description
  
    
    Link to heading
  

Dans ce challenge, nous avons acc√®s au code source d&rsquo;un script PHP ainsi qu&rsquo;√† deux indices :

Indice 1 : Lien vers la documentation PHP sur crc32()
Indice 2 : Lien vers une impl√©mentation CRC8 en PHP

L&rsquo;objectif est d&rsquo;obtenir le flag en contournant un m√©canisme d&rsquo;authentification bas√© sur des hashes CRC."><meta name=keywords content="ctf,hacking,cybersecurity,writeups,web,osint,forensic,crypto"><meta name=twitter:card content="summary"><meta name=twitter:title content="Nullcon-Goa-HackIM-2025 - Web"><meta name=twitter:description content="Web Challenge - CRC Hash Collision Exploit Link to heading Challenge Description Link to heading Dans ce challenge, nous avons acc√®s au code source d‚Äôun script PHP ainsi qu‚Äô√† deux indices :
Indice 1 : Lien vers la documentation PHP sur crc32() Indice 2 : Lien vers une impl√©mentation CRC8 en PHP L‚Äôobjectif est d‚Äôobtenir le flag en contournant un m√©canisme d‚Äôauthentification bas√© sur des hashes CRC."><meta property="og:url" content="https://anthr4ce.github.io/posts/ctf-writeups/nullcon-goa-hackim-2025/web/crahp/crahp/"><meta property="og:site_name" content="Anthrace | CTF Writeups"><meta property="og:title" content="Nullcon-Goa-HackIM-2025 - Web"><meta property="og:description" content="Web Challenge - CRC Hash Collision Exploit Link to heading Challenge Description Link to heading Dans ce challenge, nous avons acc√®s au code source d‚Äôun script PHP ainsi qu‚Äô√† deux indices :
Indice 1 : Lien vers la documentation PHP sur crc32() Indice 2 : Lien vers une impl√©mentation CRC8 en PHP L‚Äôobjectif est d‚Äôobtenir le flag en contournant un m√©canisme d‚Äôauthentification bas√© sur des hashes CRC."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-07-01T00:00:00+00:00"><meta property="article:modified_time" content="2025-07-01T00:00:00+00:00"><meta property="article:tag" content="Nullcon-Goa-Hackim-2025"><meta property="article:tag" content="Web"><meta property="article:tag" content="Crypto"><meta property="article:tag" content='Writeup"'><link rel=canonical href=https://anthr4ce.github.io/posts/ctf-writeups/nullcon-goa-hackim-2025/web/crahp/crahp/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.6445a802b9389c9660e1b07b724dcf5718b1065ed2d71b4eeaf981cc7cc5fc46.css integrity="sha256-ZEWoArk4nJZg4bB7ck3PVxixBl7S1xtO6vmBzHzF/EY=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/custom.min.75326735890e03135640e4833ec87ef2e4225b45c1ae12a57061d53d72f4157d.css integrity="sha256-dTJnNYkOAxNWQOSDPsh+8uQiW0XBrhKlcGHVPXL0FX0=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-light"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://anthr4ce.github.io/>Anthrace | CTF Writeups
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/posts/>Writeups</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://anthr4ce.github.io/posts/ctf-writeups/nullcon-goa-hackim-2025/web/crahp/crahp/>Nullcon-Goa-HackIM-2025 - Web</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2025-07-01T00:00:00Z>2025-07-01
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
5-minute read</span></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=/tags/nullcon-goa-hackim-2025/>Nullcon-Goa-Hackim-2025</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/tags/web/>Web</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/tags/crypto/>Crypto</a>
</span><span class=separator>‚Ä¢</span>
<span class=tag><a href=/tags/writeup/>Writeup"</a></span></div></div></header><div class=post-content><h1 id=web-challenge---crc-hash-collision-exploit><strong>Web Challenge - CRC Hash Collision Exploit</strong>
<a class=heading-link href=#web-challenge---crc-hash-collision-exploit><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h1><hr><h2 id=challenge-description><strong>Challenge Description</strong>
<a class=heading-link href=#challenge-description><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Dans ce challenge, nous avons acc√®s au code source d&rsquo;un script PHP ainsi qu&rsquo;√† deux indices :</p><ul><li><strong>Indice 1</strong> : <a href=https://www.php.net/manual/en/function.crc32.php#28012 class=external-link target=_blank rel=noopener>Lien vers la documentation PHP sur crc32()</a></li><li><strong>Indice 2</strong> : <a href=https://stackoverflow.com/questions/507041/crc8-check-in-php/73305496#73305496 class=external-link target=_blank rel=noopener>Lien vers une impl√©mentation CRC8 en PHP</a></li></ul><p>L&rsquo;objectif est d&rsquo;obtenir le <strong>flag</strong> en contournant un m√©canisme d&rsquo;authentification bas√© sur des <strong>hashes CRC</strong>.</p><h3 id=-crc-crc16-et-crc8><strong>üìå CRC, CRC16 et CRC8</strong>
<a class=heading-link href=#-crc-crc16-et-crc8><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>üîπ <strong>CRC (Cyclic Redundancy Check)</strong><br>Le <strong>CRC</strong> est une m√©thode de d√©tection d&rsquo;erreurs utilis√©e principalement pour v√©rifier l&rsquo;int√©grit√© des donn√©es dans les transmissions et le stockage. Il <strong>n&rsquo;est pas cryptographiquement s√©curis√©</strong>, ce qui signifie qu‚Äôil est vuln√©rable aux collisions.</p><p>üîπ <strong>CRC16 et CRC8</strong><br>Ce sont des <strong>variantes du CRC</strong> qui utilisent <strong>16 bits (CRC16)</strong> et <strong>8 bits (CRC8)</strong> pour produire une somme de contr√¥le.</p><ul><li><strong>CRC16</strong> g√©n√®re une valeur entre <strong>0x0000 et 0xFFFF</strong> (65 536 possibilit√©s).</li><li><strong>CRC8</strong> g√©n√®re une valeur entre <strong>0x00 et 0xFF</strong> (256 possibilit√©s).</li></ul><p>üîπ <strong>Pourquoi c&rsquo;est faible ?</strong><br>Contrairement aux vrais hash cryptographiques comme <strong>SHA-256</strong>, le CRC est <strong>tr√®s facile √† casser</strong> car il n&rsquo;est pas con√ßu pour la s√©curit√©. Deux entr√©es diff√©rentes peuvent souvent produire le <strong>m√™me CRC</strong>, ce qui permet d&rsquo;exploiter des <strong>collisions</strong>.</p><p>‚úÖ <strong>En r√©sum√© :</strong><br>CRC est une <strong>somme de contr√¥le rapide mais non s√©curis√©e</strong> utilis√©e pour <strong>d√©tecter</strong> des erreurs, pas pour la <strong>protection des donn√©es</strong>.</p><h2 id=analyse-du-code-source><strong>Analyse du Code Source</strong>
<a class=heading-link href=#analyse-du-code-source><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Voici les parties importantes du code PHP fournies dans le challenge :</p><h3 id=1-v√©rification-de-l><strong>1Ô∏è‚É£ V√©rification de l&rsquo;authentification</strong>
<a class=heading-link href=#1-v%c3%a9rification-de-l><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>Le script v√©rifie si l&rsquo;utilisateur soumet un mot de passe via un formulaire POST :</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#f92672>&lt;?</span><span style=color:#a6e22e>php</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(<span style=color:#a6e22e>isset</span>($_POST[<span style=color:#e6db74>&#39;password&#39;</span>]) <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>strlen</span>($MYPASSWORD) <span style=color:#f92672>==</span> <span style=color:#a6e22e>strlen</span>($_POST[<span style=color:#e6db74>&#39;password&#39;</span>])) {
</span></span><span style=display:flex><span>        $pwhash1 <span style=color:#f92672>=</span> <span style=color:#a6e22e>crc16</span>($MYPASSWORD);
</span></span><span style=display:flex><span>        $pwhash2 <span style=color:#f92672>=</span> <span style=color:#a6e22e>crc8</span>($MYPASSWORD);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        $password <span style=color:#f92672>=</span> $_POST[<span style=color:#e6db74>&#39;password&#39;</span>];
</span></span><span style=display:flex><span>        $pwhash3 <span style=color:#f92672>=</span> <span style=color:#a6e22e>crc16</span>($password);
</span></span><span style=display:flex><span>        $pwhash4 <span style=color:#f92672>=</span> <span style=color:#a6e22e>crc8</span>($password);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>($MYPASSWORD <span style=color:#f92672>==</span> $password) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;oops. Try harder!&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>($pwhash1 <span style=color:#f92672>!=</span> $pwhash3) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;Oops. Nope. Try harder!&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>($pwhash2 <span style=color:#f92672>!=</span> $pwhash4) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>die</span>(<span style=color:#e6db74>&#34;OoOps. Not quite. Try harder!&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        $access <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span>($access) {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;You win a flag: </span><span style=color:#e6db74>$FLAG</span><span style=color:#e6db74>&#34;</span>;
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;Denied! :-(&#34;</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>        } <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>echo</span> <span style=color:#e6db74>&#34;Try harder!&#34;</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span><span style=color:#75715e>?&gt;</span><span style=color:#960050;background-color:#1e0010>
</span></span></span></code></pre></div><h3 id=2-points-cl√©s-√†-retenir><strong>2Ô∏è‚É£ Points cl√©s √† retenir</strong>
<a class=heading-link href=#2-points-cl%c3%a9s-%c3%a0-retenir><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><ul><li><strong>Le mot de passe original est <code>AdM1nP@assW0rd!</code></strong>.</li><li><strong>Nous ne pouvons pas soumettre ce m√™me mot de passe directement</strong> (<code>if($MYPASSWORD == $password)</code>).</li><li><strong>La validation se fait via deux fonctions CRC (<code>crc16</code> et <code>crc8</code>)</strong> :<ul><li><code>crc16($MYPASSWORD) == crc16($password)</code></li><li><code>crc8($MYPASSWORD) == crc8($password)</code></li></ul></li><li><strong>Si ces deux valeurs sont identiques, nous obtenons le flag !</strong></li></ul><h2 id=exploitation--collision-crc><strong>Exploitation : Collision CRC</strong>
<a class=heading-link href=#exploitation--collision-crc><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>Les fonctions <strong>CRC16 et CRC8</strong> ne sont <strong>pas cryptographiquement s√©curis√©es</strong>. Il est possible de trouver une <strong>collision</strong> (un mot de passe diff√©rent g√©n√©rant les m√™mes valeurs CRC).</p><h3 id=-objectif><strong>üéØ Objectif</strong>
<a class=heading-link href=#-objectif><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>Trouver un mot de passe <strong>diff√©rent</strong> de <code>AdM1nP@assW0rd!</code> qui a <strong>la m√™me valeur CRC16 et CRC8</strong>.</p><h3 id=√©tapes-de-lexploitation><strong>√âtapes de l‚ÄôExploitation</strong>
<a class=heading-link href=#%c3%a9tapes-de-lexploitation><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>Nous allons utiliser <strong>un script Python</strong> pour :</p><ol><li><strong>Calculer les valeurs CRC16 et CRC8</strong>.</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>from</span> pwn <span style=color:#f92672>import</span> <span style=color:#f92672>*</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> itertools
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> string
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> multiprocessing
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>crc16</span>(data: str):
</span></span><span style=display:flex><span>    crc <span style=color:#f92672>=</span> <span style=color:#ae81ff>0xFFFF</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> char <span style=color:#f92672>in</span> data:
</span></span><span style=display:flex><span>        crc <span style=color:#f92672>^=</span> ord(char)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> _ <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>8</span>):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> crc <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>                crc <span style=color:#f92672>=</span> (crc <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>1</span>) <span style=color:#f92672>^</span> <span style=color:#ae81ff>0xA001</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                crc <span style=color:#f92672>&gt;&gt;=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> crc
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>crc8</span>(data: str):
</span></span><span style=display:flex><span>    crc8Table <span style=color:#f92672>=</span> [
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x00</span>, <span style=color:#ae81ff>0x07</span>, <span style=color:#ae81ff>0x0E</span>, <span style=color:#ae81ff>0x09</span>, <span style=color:#ae81ff>0x1C</span>, <span style=color:#ae81ff>0x1B</span>, <span style=color:#ae81ff>0x12</span>, <span style=color:#ae81ff>0x15</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x38</span>, <span style=color:#ae81ff>0x3F</span>, <span style=color:#ae81ff>0x36</span>, <span style=color:#ae81ff>0x31</span>, <span style=color:#ae81ff>0x24</span>, <span style=color:#ae81ff>0x23</span>, <span style=color:#ae81ff>0x2A</span>, <span style=color:#ae81ff>0x2D</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x70</span>, <span style=color:#ae81ff>0x77</span>, <span style=color:#ae81ff>0x7E</span>, <span style=color:#ae81ff>0x79</span>, <span style=color:#ae81ff>0x6C</span>, <span style=color:#ae81ff>0x6B</span>, <span style=color:#ae81ff>0x62</span>, <span style=color:#ae81ff>0x65</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x48</span>, <span style=color:#ae81ff>0x4F</span>, <span style=color:#ae81ff>0x46</span>, <span style=color:#ae81ff>0x41</span>, <span style=color:#ae81ff>0x54</span>, <span style=color:#ae81ff>0x53</span>, <span style=color:#ae81ff>0x5A</span>, <span style=color:#ae81ff>0x5D</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0xE0</span>, <span style=color:#ae81ff>0xE7</span>, <span style=color:#ae81ff>0xEE</span>, <span style=color:#ae81ff>0xE9</span>, <span style=color:#ae81ff>0xFC</span>, <span style=color:#ae81ff>0xFB</span>, <span style=color:#ae81ff>0xF2</span>, <span style=color:#ae81ff>0xF5</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0xD8</span>, <span style=color:#ae81ff>0xDF</span>, <span style=color:#ae81ff>0xD6</span>, <span style=color:#ae81ff>0xD1</span>, <span style=color:#ae81ff>0xC4</span>, <span style=color:#ae81ff>0xC3</span>, <span style=color:#ae81ff>0xCA</span>, <span style=color:#ae81ff>0xCD</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x90</span>, <span style=color:#ae81ff>0x97</span>, <span style=color:#ae81ff>0x9E</span>, <span style=color:#ae81ff>0x99</span>, <span style=color:#ae81ff>0x8C</span>, <span style=color:#ae81ff>0x8B</span>, <span style=color:#ae81ff>0x82</span>, <span style=color:#ae81ff>0x85</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0xA8</span>, <span style=color:#ae81ff>0xAF</span>, <span style=color:#ae81ff>0xA6</span>, <span style=color:#ae81ff>0xA1</span>, <span style=color:#ae81ff>0xB4</span>, <span style=color:#ae81ff>0xB3</span>, <span style=color:#ae81ff>0xBA</span>, <span style=color:#ae81ff>0xBD</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0xC7</span>, <span style=color:#ae81ff>0xC0</span>, <span style=color:#ae81ff>0xC9</span>, <span style=color:#ae81ff>0xCE</span>, <span style=color:#ae81ff>0xDB</span>, <span style=color:#ae81ff>0xDC</span>, <span style=color:#ae81ff>0xD5</span>, <span style=color:#ae81ff>0xD2</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0xFF</span>, <span style=color:#ae81ff>0xF8</span>, <span style=color:#ae81ff>0xF1</span>, <span style=color:#ae81ff>0xF6</span>, <span style=color:#ae81ff>0xE3</span>, <span style=color:#ae81ff>0xE4</span>, <span style=color:#ae81ff>0xED</span>, <span style=color:#ae81ff>0xEA</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0xB7</span>, <span style=color:#ae81ff>0xB0</span>, <span style=color:#ae81ff>0xB9</span>, <span style=color:#ae81ff>0xBE</span>, <span style=color:#ae81ff>0xAB</span>, <span style=color:#ae81ff>0xAC</span>, <span style=color:#ae81ff>0xA5</span>, <span style=color:#ae81ff>0xA2</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x8F</span>, <span style=color:#ae81ff>0x88</span>, <span style=color:#ae81ff>0x81</span>, <span style=color:#ae81ff>0x86</span>, <span style=color:#ae81ff>0x93</span>, <span style=color:#ae81ff>0x94</span>, <span style=color:#ae81ff>0x9D</span>, <span style=color:#ae81ff>0x9A</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x27</span>, <span style=color:#ae81ff>0x20</span>, <span style=color:#ae81ff>0x29</span>, <span style=color:#ae81ff>0x2E</span>, <span style=color:#ae81ff>0x3B</span>, <span style=color:#ae81ff>0x3C</span>, <span style=color:#ae81ff>0x35</span>, <span style=color:#ae81ff>0x32</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x1F</span>, <span style=color:#ae81ff>0x18</span>, <span style=color:#ae81ff>0x11</span>, <span style=color:#ae81ff>0x16</span>, <span style=color:#ae81ff>0x03</span>, <span style=color:#ae81ff>0x04</span>, <span style=color:#ae81ff>0x0D</span>, <span style=color:#ae81ff>0x0A</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x57</span>, <span style=color:#ae81ff>0x50</span>, <span style=color:#ae81ff>0x59</span>, <span style=color:#ae81ff>0x5E</span>, <span style=color:#ae81ff>0x4B</span>, <span style=color:#ae81ff>0x4C</span>, <span style=color:#ae81ff>0x45</span>, <span style=color:#ae81ff>0x42</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x6F</span>, <span style=color:#ae81ff>0x68</span>, <span style=color:#ae81ff>0x61</span>, <span style=color:#ae81ff>0x66</span>, <span style=color:#ae81ff>0x73</span>, <span style=color:#ae81ff>0x74</span>, <span style=color:#ae81ff>0x7D</span>, <span style=color:#ae81ff>0x7A</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x89</span>, <span style=color:#ae81ff>0x8E</span>, <span style=color:#ae81ff>0x87</span>, <span style=color:#ae81ff>0x80</span>, <span style=color:#ae81ff>0x95</span>, <span style=color:#ae81ff>0x92</span>, <span style=color:#ae81ff>0x9B</span>, <span style=color:#ae81ff>0x9C</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0xB1</span>, <span style=color:#ae81ff>0xB6</span>, <span style=color:#ae81ff>0xBF</span>, <span style=color:#ae81ff>0xB8</span>, <span style=color:#ae81ff>0xAD</span>, <span style=color:#ae81ff>0xAA</span>, <span style=color:#ae81ff>0xA3</span>, <span style=color:#ae81ff>0xA4</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0xF9</span>, <span style=color:#ae81ff>0xFE</span>, <span style=color:#ae81ff>0xF7</span>, <span style=color:#ae81ff>0xF0</span>, <span style=color:#ae81ff>0xE5</span>, <span style=color:#ae81ff>0xE2</span>, <span style=color:#ae81ff>0xEB</span>, <span style=color:#ae81ff>0xEC</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0xC1</span>, <span style=color:#ae81ff>0xC6</span>, <span style=color:#ae81ff>0xCF</span>, <span style=color:#ae81ff>0xC8</span>, <span style=color:#ae81ff>0xDD</span>, <span style=color:#ae81ff>0xDA</span>, <span style=color:#ae81ff>0xD3</span>, <span style=color:#ae81ff>0xD4</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x69</span>, <span style=color:#ae81ff>0x6E</span>, <span style=color:#ae81ff>0x67</span>, <span style=color:#ae81ff>0x60</span>, <span style=color:#ae81ff>0x75</span>, <span style=color:#ae81ff>0x72</span>, <span style=color:#ae81ff>0x7B</span>, <span style=color:#ae81ff>0x7C</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x51</span>, <span style=color:#ae81ff>0x56</span>, <span style=color:#ae81ff>0x5F</span>, <span style=color:#ae81ff>0x58</span>, <span style=color:#ae81ff>0x4D</span>, <span style=color:#ae81ff>0x4A</span>, <span style=color:#ae81ff>0x43</span>, <span style=color:#ae81ff>0x44</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x19</span>, <span style=color:#ae81ff>0x1E</span>, <span style=color:#ae81ff>0x17</span>, <span style=color:#ae81ff>0x10</span>, <span style=color:#ae81ff>0x05</span>, <span style=color:#ae81ff>0x02</span>, <span style=color:#ae81ff>0x0B</span>, <span style=color:#ae81ff>0x0C</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x21</span>, <span style=color:#ae81ff>0x26</span>, <span style=color:#ae81ff>0x2F</span>, <span style=color:#ae81ff>0x28</span>, <span style=color:#ae81ff>0x3D</span>, <span style=color:#ae81ff>0x3A</span>, <span style=color:#ae81ff>0x33</span>, <span style=color:#ae81ff>0x34</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x4E</span>, <span style=color:#ae81ff>0x49</span>, <span style=color:#ae81ff>0x40</span>, <span style=color:#ae81ff>0x47</span>, <span style=color:#ae81ff>0x52</span>, <span style=color:#ae81ff>0x55</span>, <span style=color:#ae81ff>0x5C</span>, <span style=color:#ae81ff>0x5B</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x76</span>, <span style=color:#ae81ff>0x71</span>, <span style=color:#ae81ff>0x78</span>, <span style=color:#ae81ff>0x7F</span>, <span style=color:#ae81ff>0x6A</span>, <span style=color:#ae81ff>0x6D</span>, <span style=color:#ae81ff>0x64</span>, <span style=color:#ae81ff>0x63</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x3E</span>, <span style=color:#ae81ff>0x39</span>, <span style=color:#ae81ff>0x30</span>, <span style=color:#ae81ff>0x37</span>, <span style=color:#ae81ff>0x22</span>, <span style=color:#ae81ff>0x25</span>, <span style=color:#ae81ff>0x2C</span>, <span style=color:#ae81ff>0x2B</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x06</span>, <span style=color:#ae81ff>0x01</span>, <span style=color:#ae81ff>0x08</span>, <span style=color:#ae81ff>0x0F</span>, <span style=color:#ae81ff>0x1A</span>, <span style=color:#ae81ff>0x1D</span>, <span style=color:#ae81ff>0x14</span>, <span style=color:#ae81ff>0x13</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0xAE</span>, <span style=color:#ae81ff>0xA9</span>, <span style=color:#ae81ff>0xA0</span>, <span style=color:#ae81ff>0xA7</span>, <span style=color:#ae81ff>0xB2</span>, <span style=color:#ae81ff>0xB5</span>, <span style=color:#ae81ff>0xBC</span>, <span style=color:#ae81ff>0xBB</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0x96</span>, <span style=color:#ae81ff>0x91</span>, <span style=color:#ae81ff>0x98</span>, <span style=color:#ae81ff>0x9F</span>, <span style=color:#ae81ff>0x8A</span>, <span style=color:#ae81ff>0x8D</span>, <span style=color:#ae81ff>0x84</span>, <span style=color:#ae81ff>0x83</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0xDE</span>, <span style=color:#ae81ff>0xD9</span>, <span style=color:#ae81ff>0xD0</span>, <span style=color:#ae81ff>0xD7</span>, <span style=color:#ae81ff>0xC2</span>, <span style=color:#ae81ff>0xC5</span>, <span style=color:#ae81ff>0xCC</span>, <span style=color:#ae81ff>0xCB</span>,
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>0xE6</span>, <span style=color:#ae81ff>0xE1</span>, <span style=color:#ae81ff>0xE8</span>, <span style=color:#ae81ff>0xEF</span>, <span style=color:#ae81ff>0xFA</span>, <span style=color:#ae81ff>0xFD</span>, <span style=color:#ae81ff>0xF4</span>, <span style=color:#ae81ff>0xF3</span>
</span></span><span style=display:flex><span>    ]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    crc <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> char <span style=color:#f92672>in</span> data:
</span></span><span style=display:flex><span>        crc <span style=color:#f92672>=</span> crc8Table[(crc <span style=color:#f92672>^</span> ord(char)) <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFF</span>]
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> crc <span style=color:#f92672>&amp;</span> <span style=color:#ae81ff>0xFF</span>
</span></span></code></pre></div><ol start=2><li><strong>G√©n√©ration de la collision</strong> et <strong>v√©rifier si elles produisent la m√™me valeur CRC</strong>.</li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#a6e22e>original_password</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;AdM1nP@assW0rd!&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>crc16_target</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>crc16</span>(<span style=color:#a6e22e>original_password</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>crc8_target</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>crc8</span>(<span style=color:#a6e22e>original_password</span>)
</span></span></code></pre></div><ol start=3><li><strong>Optimisation : Multi-threading</strong></li></ol><p>Le bruteforce peut √™tre tr√®s lent.
J&rsquo;ai donc utilis√© PwnTools et multiprocessing pour acc√©l√©rer la recherche en r√©partissant les calculs sur plusieurs c≈ìurs avec un offset.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>original_password <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;AdM1nP@assW0rd!&#34;</span>
</span></span><span style=display:flex><span>crc16_target <span style=color:#f92672>=</span> crc16(original_password)
</span></span><span style=display:flex><span>crc8_target <span style=color:#f92672>=</span> crc8(original_password)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#char to test</span>
</span></span><span style=display:flex><span>charset <span style=color:#f92672>=</span> string<span style=color:#f92672>.</span>ascii_letters <span style=color:#f92672>+</span> string<span style=color:#f92672>.</span>digits <span style=color:#f92672>+</span> string<span style=color:#f92672>.</span>punctuation
</span></span><span style=display:flex><span>password_length <span style=color:#f92672>=</span> len(original_password)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#multi threading</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>brute_force</span>(start_idx):
</span></span><span style=display:flex><span>    <span style=color:#75715e>#offset pour aller plus vite</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> attempt <span style=color:#f92672>in</span> itertools<span style=color:#f92672>.</span>islice(itertools<span style=color:#f92672>.</span>product(charset, repeat<span style=color:#f92672>=</span>password_length), start_idx, <span style=color:#66d9ef>None</span>, multiprocessing<span style=color:#f92672>.</span>cpu_count()):
</span></span><span style=display:flex><span>        test_password <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join(attempt)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> test_password <span style=color:#f92672>!=</span> original_password <span style=color:#f92672>and</span> crc16(test_password) <span style=color:#f92672>==</span> crc16_target <span style=color:#f92672>and</span> crc8(test_password) <span style=color:#f92672>==</span> crc8_target:
</span></span><span style=display:flex><span>            print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;lmaoo got a lmaoollision: </span><span style=color:#e6db74>{</span>test_password<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    num_cores <span style=color:#f92672>=</span> multiprocessing<span style=color:#f92672>.</span>cpu_count()  
</span></span><span style=display:flex><span>    pool <span style=color:#f92672>=</span> multiprocessing<span style=color:#f92672>.</span>Pool(processes<span style=color:#f92672>=</span>num_cores)
</span></span><span style=display:flex><span>    pool<span style=color:#f92672>.</span>map(brute_force, range(num_cores))
</span></span></code></pre></div><h3 id=mot-de-passe-trouv√©><strong>Mot de passe trouv√©</strong>
<a class=heading-link href=#mot-de-passe-trouv%c3%a9><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h3><p>Apr√®s ex√©cution, le script a trouv√© plusieurs mot de passe (ou lmaoollision) <strong>diff√©rents</strong> de <code>AdM1nP@assW0rd!</code> mais avec les <strong>m√™mes valeurs CRC16 et CRC8</strong>.</p><p><img src=images/collision_found.png alt=Screenshot></p><p>Et la flag:</p><p><img src=images/collision_flag_found.png alt=Screenshot></p><h2 id=conclusion><strong>Conclusion</strong>
<a class=heading-link href=#conclusion><i class="fa-solid fa-link" aria-hidden=true title="Link to heading"></i>
<span class=sr-only>Link to heading</span></a></h2><p>üîπ <strong>Le probl√®me :</strong> L&rsquo;utilisation de <strong>CRC16 et CRC8 pour la validation d&rsquo;un mot de passe</strong> est une tr√®s mauvaise pratique car les CRC <strong>ne sont pas r√©sistants aux collisions</strong>.<br>üîπ <strong>L&rsquo;attaque :</strong> Nous avons utilis√© <strong>un script Python en multi-threading</strong> pour trouver une <strong>collision CRC</strong> et contourner l&rsquo;authentification.<br>üîπ <strong>Le r√©sultat :</strong> En soumettant un mot de passe diff√©rent mais avec la m√™me empreinte CRC, nous avons r√©ussi √† <strong>r√©cup√©rer le flag</strong> !</p><p>Pour √©viter ce genre de vuln√©rabilit√©, il faut <strong>toujours utiliser des fonctions de hachage cryptographiques comme SHA256 ou bcrypt</strong>, et <strong>√©viter les CRC pour la s√©curit√©</strong>.</p></div><footer></footer></article></section></div><footer class=footer><section class=container>¬©
2025
Anthrace
¬∑
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>